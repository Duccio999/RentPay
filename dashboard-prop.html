<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dashboard Proprietario — RentPay</title>
  <meta name="description" content="Panoramica contratti, incassi e garanzia per il proprietario.">
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<!-- NAVBAR -->
<nav class="rp-nav">
  <a class="rp-brand" href="./index.html" aria-label="RentPay Home">
    <span class="rp-house" aria-hidden="true">🏠</span><span class="rp-brand-text">RentPay</span>
  </a>
  <div class="rp-menu-desktop">
    <a href="./index.html">Home</a>
    <a href="./vision.html">Visione</a>
    <a href="./funzioni.html">Funzioni</a>
    <a href="./garanzia.html">Garanzia</a>
    <a href="./prezzi.html">Prezzi</a>
    <a href="./firma.html">Firma (demo)</a>
    <a class="rp-accent" href="./login.html">Cambia account</a>
  </div>
  <button id="rpHamburger" class="rp-hamburger" aria-label="Apri menu" aria-expanded="false">☰</button>
</nav>

<!-- Drawer mobile -->
<aside id="rpDrawer" class="rp-drawer" aria-hidden="true">
  <div class="rp-drawer-head">
    <span class="rp-drawer-title">Menù</span>
    <button id="rpDrawerClose" class="rp-close" aria-label="Chiudi menu">×</button>
  </div>
  <a href="./index.html">Home</a>
  <a href="./vision.html">Visione</a>
  <a href="./funzioni.html">Funzioni</a>
  <a href="./garanzia.html">Garanzia</a>
  <a href="./prezzi.html">Prezzi</a>
  <a href="./firma.html">Firma (demo)</a>
  <a class="rp-accent" href="./login.html">Cambia account</a>
</aside>
<div id="rpBackdrop" class="rp-backdrop" hidden></div>

<main class="container">
  <section class="hero card" style="margin-bottom:18px">
    <h1 id="welcome">Benvenuto</h1>
    <p class="lead">Panoramica dei tuoi immobili, contratti e incassi (DEMO).</p>
  </section>

  <!-- Garanzia -->
  <section class="card" style="margin-bottom:16px">
    <h2>🛡️ Garanzia</h2>
    <p id="garanziaInfo">Attiva su 0 contratti.</p>
    <div class="actions"><a class="btn" href="./garanzia.html">Dettagli garanzia</a></div>
  </section>

  <!-- Contratti -->
  <section class="card" style="margin-bottom:16px">
    <h2>📄 Contratti</h2>
    <div class="table-wrap">
      <table class="rp-table" id="tblContratti">
        <thead><tr><th>Immobile</th><th>Inquilino</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
    <div class="actions" style="margin-top:10px">
      <a class="btn" href="./firma.html">Crea nuovo contratto (demo)</a>
    </div>
  </section>

  <!-- Incassi recenti -->
  <section class="card">
    <h2>💳 Incassi recenti</h2>
    <div class="table-wrap">
      <table class="rp-table" id="tblIncassi">
        <thead><tr><th>Data</th><th>Contratto</th><th>Importo</th><th>Stato</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </section>
</main>

<footer class="footer container">
  <div class="f-links">
    <a href="terms.html">Termini di servizio</a>
    <a href="privacy.html">Privacy Policy</a>
    <a href="cookie.html">Cookie Policy</a>
  </div>
  <div class="copy">© 2025 RentPay — PWA</div>
</footer>

<!-- NAV JS -->
<script type="text/javascript">
(function(){
  const btn=document.getElementById('rpHamburger'),
        drawer=document.getElementById('rpDrawer'),
        closeBtn=document.getElementById('rpDrawerClose'),
        backdrop=document.getElementById('rpBackdrop');
  function openD(){drawer.classList.add('open');backdrop.hidden=false;backdrop.classList.add('show');document.body.style.overflow='hidden'}
  function closeD(){drawer.classList.remove('open');backdrop.classList.remove('show');backdrop.hidden=true;document.body.style.overflow=''}
  btn&&btn.addEventListener('click',openD);
  closeBtn&&closeBtn.addEventListener('click',closeD);
  backdrop&&backdrop.addEventListener('click',closeD);
  window.addEventListener('keydown',e=>{if(e.key==='Escape')closeD()});
  drawer.querySelectorAll('a').forEach(a=>a.addEventListener('click',closeD));
})();
</script>

<!-- DATA + RENDER -->
<script>
(function(){
  // Utente corrente (o fallback demo)
  const current = JSON.parse(localStorage.getItem('rpCurrentUser')||'{}');
  const name = current?.name || 'Proprietario demo';
  document.getElementById('welcome').textContent = `Benvenuto, ${name}`;

  // Dati demo legati ai contratti del proprietario
  const contratti = [
    { immobile:'Via Roma 12', inquilino:'Luca Bianchi', garantito:true },
    { immobile:'Via Po 8',   inquilino:'Giulia Neri',  garantito:true }
  ];
  const incassi = [
    { data:'01/09', contratto:'Via Roma 12', importo:850, stato:'Completato' },
    { data:'01/09', contratto:'Via Po 8',   importo:720, stato:'Completato' },
    { data:'01/08', contratto:'Via Roma 12', importo:850, stato:'Completato' }
  ];

  // Garanzia: quante righe marcate garantito
  const garantiti = contratti.filter(c=>c.garantito).length;
  document.getElementById('garanziaInfo').textContent = `Attiva su ${garantiti} contratti.`;

  // Render contratti
  const tbC = document.querySelector('#tblContratti tbody');
  tbC.innerHTML = contratti.map(c=>(
    `<tr><td>${c.immobile}</td><td>${c.inquilino}</td></tr>`
  )).join('');

  // Render incassi
  const nf = new Intl.NumberFormat('it-IT',{style:'currency',currency:'EUR',maximumFractionDigits:0});
  const tbI = document.querySelector('#tblIncassi tbody');
  tbI.innerHTML = incassi.map(r=>(
    `<tr>
      <td>${r.data}</td>
      <td>${r.contratto}</td>
      <td class="rp-amount">${nf.format(r.importo)}</td>
      <td>${r.stato}</td>
    </tr>`
  )).join('');
})();
</script>
</body>
</html>
